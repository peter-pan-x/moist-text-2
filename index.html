<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>èŒ¶ç ”å®˜ä½“è´¨æ£€æµ‹åŠ©æ‰‹</title>
    <style>
        body {
            margin: 0;
            font-family: "æ€æºå®‹ä½“", "Microsoft YaHei", "PingFang SC", sans-serif;
            background: linear-gradient(to bottom, #f8f6f0, #dfeee7);
            color: #3a2922;
            padding-bottom: 80px;
        }
        .logo-container {
            text-align: center;
            padding: 40px 20px 20px;
        }
        .logo-container img {
            max-width: 180px;
            border-radius: 20px;
        }
        .main-content {
            max-width: 800px;
            margin: 0 auto 20px auto;
            padding: 25px 30px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.08);
            text-align: center;
        }
        h1 {
            font-size: 2.2em;
            color: #5a4d3b;
            margin-bottom: 10px;
        }
        h2 {
            font-size: 1.8em;
            color: #5a4d3b;
        }
        p {
            font-size: 1.1em;
            line-height: 1.8;
            color: #6a5b4d;
        }
        .test-button {
            margin: 10px auto;
            padding: 15px 40px;
            background: linear-gradient(135deg, #cddfc9, #b4d3b2);
            color: #2f3a1d;
            border: none;
            border-radius: 30px;
            font-size: 1.1em;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 6px 15px rgba(0,0,0,0.1);
            transition: 0.3s ease;
        }
        .test-button:hover {
            background: linear-gradient(135deg, #b4d3b2, #a3c6a2);
            transform: translateY(-2px);
        }
        .footer-idea {
            text-align: center;
            font-size: 1.4em;
            margin: 60px 20px 30px;
            color: #6a5b4d;
            font-family: 'KaiTi', 'STKaiti', serif;
        }

        /* ----- Common Test Styles ----- */
        .question-card, .result-box, #nineConstitutionsContainer {
            display: none;
        }
        .back-button {
            display: block;
            width: fit-content;
            margin: 30px auto 0;
            padding: 10px 20px;
            font-size: 1em;
            background-color: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 20px;
            cursor: pointer;
        }

        /* ----- 9 Constitutions Test Styles ----- */
        #nineConstitutionsContainer {
            text-align: left;
        }
        .question-block {
            border-bottom: 1px solid #eee;
            padding: 15px 0;
        }
        .question-block:last-child {
            border-bottom: none;
        }
        .question-title {
            font-size: 1.1em;
            font-weight: bold;
            color: #5a4d3b;
            padding: 5px;
        }
        .question-options {
            display: none;
            padding-top: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        .question-block.expanded .question-options {
            display: flex;
        }
        .option-btn {
            padding: 10px 15px;
            border: 1px solid #ccc;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: #f9f9f9;
            color: #555;
            font-size: 1em;
        }
        .option-btn:hover {
            background-color: #e9e9e9;
            border-color: #b3b3b3;
        }
        .option-btn.selected {
            background-color: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }
        #calculateBtn {
            margin-top: 30px;
        }
        
        /* ----- Result Page Styles (UPDATED) ----- */
        #resultContentNine {
            font-size: 1.4em;
            line-height: 1.8;
        }
        #resultContentNine .main-constitution-name {
            color: red;
            font-weight: bold;
            font-size: 1.3em; /* æ”¾å¤§ä¸»ä½“è´¨å­—ä½“ */
        }
        #resultContentNine .secondary-constitution-name {
            color: #8A2BE2;
        }

        .constitution-details-main, .constitution-details-secondary {
            text-align: left;
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        .constitution-details-main h3 {
            font-size: 1.5em;
            color: #3a2922;
        }
        .constitution-details-main p, .constitution-details-secondary p {
            font-size: 1em;
            line-height: 1.7;
        }
        .constitution-details-secondary {
             font-size: 0.9em; /* åå‘ä½“è´¨ä»‹ç»å­—ä½“ç¼©å° */
             color: #666;
        }
        .constitution-details-secondary h3 {
             font-size: 1.4em;
        }
    </style>
</head>
<body>
    <div class="logo-container">
        <img src="logo.png" alt="Logo">
    </div>

    <div class="main-content" id="welcome">
        <h1>æ¬¢è¿ä½¿ç”¨èŒ¶ç ”å®˜ä½“è´¨æ£€æµ‹åŠ©æ‰‹</h1>
        <p>è¯·é€‰æ‹©æ‚¨è¦è¿›è¡Œçš„æ£€æµ‹ç±»å‹ï¼š</p>
        <div style="display: flex; flex-direction: column; align-items: center; gap: 30px; margin-top: 30px;">
            <button class="test-button" onclick="startDampnessTest()">ğŸŒ¿ æ¹¿æ°”æ£€æµ‹</button>
            <button class="test-button" onclick="startNineConstitutionsTest()">ğŸ§¬ ä¹å‹ä½“è´¨æ£€æµ‹</button>
        </div>
    </div>

    <div class="main-content question-card" id="dampnessQuestionBox">
        <div id="dampnessQuestionText"></div>
        <button class="test-button" onclick="answerDampness(true)">æ˜¯</button>
        <button class="test-button" onclick="answerDampness(false)">å¦</button>
    </div>
    <div class="main-content result-box" id="dampnessResultBox">
        <h2>æ£€æµ‹ç»“æœ</h2>
        <div id="dampnessResultContent" style="font-size: 1.1em; text-align: left;"></div>
        <button class="back-button" onclick="goHome()">è¿”å›é¦–é¡µ</button>
    </div>

    <div class="main-content" id="nineConstitutionsContainer">
        </div>
    <div class="main-content result-box" id="nineConstitutionsResultBox">
        <h2>æ‚¨çš„ä½“è´¨æ£€æµ‹ç»“æœ</h2>
        <p id="resultContentNine"></p>
        <div id="mainConstitutionDetails" class="constitution-details-main"></div>
        <div id="secondaryConstitutionDetails" class="constitution-details-secondary"></div>
        <button class="back-button" onclick="goHome()">è¿”å›é¦–é¡µ</button>
    </div>

    <div class="footer-idea">å‘é˜³è€Œç”Ÿ</div>

    <script>
        // =================================================================
        // SCRIPT FOR DAMPNESS TEST
        // =================================================================
        const dampQuestions = [
            "1ã€æ‚¨æ˜¯å¦å¤´éƒ¨æ˜æ˜æ²‰æ²‰ã€æ²¡æœ‰ç²¾ç¥ã€ç»å¸¸å¤´æ™•ä¹åŠ›ï¼Ÿ", "2ã€æ‚¨æ˜¯å¦èº«ä½“å‘æ²‰ã€å››è‚¢é…¸ç—›ã€æ— åŠ›ã€æ˜æ˜æ¬²ç¡ï¼Ÿ", "3ã€æ‚¨æ˜¯å¦å—œç¡ã€è´ªç¡ã€è€æ˜¯ç¡ä¸é†’ï¼Œç¡è§‰å®¹æ˜“æ‰“å‘¼å™œï¼Ÿ", "4ã€æ‚¨æ˜¯å¦æ˜“ä¾¿ç§˜ï¼Œå¤§ä¾¿ä¸è§„å¾‹ã€ä¸æˆå‹ã€ç²˜è¿é©¬æ¡¶ï¼Ÿ", "5ã€æ‚¨æ˜¯å¦é£Ÿæ¬²ä¸æŒ¯ã€æ˜“åèƒƒæ¶å¿ƒã€èƒƒç–¼è…¹èƒ€ã€æ¶ˆåŒ–ä¸å¥½ï¼Œæ˜“è…¹æ³»ï¼Ÿ", "6ã€æ‚¨æ˜¯å¦æœ‰æ—¶å€™ä¼šè§‰å¾—å‘¼å¸è´¹åŠ›ã€å‘¼å¸ä¸ç•…ï¼Œèƒ¸é—·ä¸èˆ’ï¼Ÿ", "7ã€æ‚¨æ˜¯å¦æ˜“é•¿ç—˜ç—˜ã€è‰²æ–‘ï¼Œæ¯›å­”ç²—å¤§ï¼Œçœ¼è¢‹æµ®è‚¿ï¼Œé¢è‰²é»„æš—ï¼Œæ³›æ²¹å…‰ï¼Ÿ", "8ã€æ‚¨æ˜¯å¦çš®è‚¤ç»å¸¸è«åå‘ç—’ï¼Œè¿‡æ•ã€æ¹¿ç–¹ã€è¨éº»ç–¹åå¤å‘ä½œï¼Ÿ", "9ã€æ‚¨æ˜¯å¦å¤´å‘æ‰ä¸€å¤©æ²¡æ´—ï¼Œå°±å®¹æ˜“æ²¹è…»ï¼Œæœ‰å¤´å±‘ï¼Ÿ", "10ã€æ‚¨æ˜¯å¦å£å¹²ã€å£è‡­ã€å£è‹¦ã€æœ‰å¼‚å‘³ï¼Œç»å¸¸æ³›é…¸æ¶å¿ƒï¼Ÿ", "11ã€æ‚¨æ˜¯å¦æ—©èµ·ç—°å¤šã€èˆŒè‹”åšè…»ï¼ŒèˆŒå¤´è¾¹ç¼˜æœ‰é”¯é½¿ï¼Œæ˜“å£è…”æºƒç–¡ï¼Ÿ", "12ã€æ‚¨æ˜¯å¦ç‰™é½¿åé»„ã€æ— å…‰æ³½ï¼Œç‰™é¾ˆè‰²çº¢ï¼Œå£å”‡åçº¢ï¼Œæˆ–å‘ç™½åšè…»ï¼Ÿ", "13ã€æ‚¨æ˜¯å¦è…¿è„šå®¹æ˜“æµ®è‚¿ï¼Œè„šè‡­ã€æ±—å‘³é‡ã€ä½“å‘³å¤§ï¼Ÿ", "14ã€æ‚¨æ˜¯å¦è…°è…¹è„‚è‚ªå †ç§¯ï¼Œå¤§è‚šè…©ã€æ¸¸æ³³åœˆã€ä½“å‹è‚¥èƒ–ã€è‡ƒè‚¿ï¼Ÿ", "15ã€æ‚¨æ˜¯å¦å°¿é‡å°‘ã€æ¬¡æ•°å°‘ï¼Œç”·æ€§é˜´å›Šæ½®æ¹¿æˆ–è€…å¥³æ€§ç™½å¸¦å¼‚å¸¸ï¼Ÿ"
        ];
        let dampnessTestState = { current: 0, score: 0 };

        function startDampnessTest() {
            document.getElementById('welcome').style.display = 'none';
            document.getElementById('dampnessQuestionBox').style.display = 'block';
            dampnessTestState = { current: 0, score: 0 };
            showDampnessQuestion();
        }
        function showDampnessQuestion() { document.getElementById('dampnessQuestionText').innerText = dampQuestions[dampnessTestState.current]; }
        function answerDampness(yes) {
            if (yes) dampnessTestState.score++;
            dampnessTestState.current++;
            if (dampnessTestState.current < dampQuestions.length) { showDampnessQuestion(); } else { showDampnessResult(); }
        }
        function showDampnessResult() {
            document.getElementById('dampnessQuestionBox').style.display = 'none';
            document.getElementById('dampnessResultBox').style.display = 'block';
            let result = ""; const score = dampnessTestState.score;
            if (score === 0) { result = "æ²¡æœ‰æ¹¿æ°”ï¼šæ‚¨çš„èº«ä½“éå¸¸å¥åº·ï¼Œè¦ç»§ç»­ä¿æŒå“¦ã€‚"; } else if (score < 3) { result = "è½»å¾®æ¹¿æ°”ï¼šåäººä¹æ¹¿ï¼Œæœ‰è½»å¾®çš„æ¹¿æ°”å®å±æ­£å¸¸ï¼Œå¯ä»¥é€‚å½“çš„å¢åŠ è¿åŠ¨é‡ï¼Œå°‘å¹ç©ºè°ƒï¼ŒçƒŸé…’é€‚é‡ï¼Œç”Ÿå†·åˆºæ¿€ã€å‡‰æ€§çš„é£Ÿç‰©å°‘åƒå³å¯ã€‚"; } else if (score < 8) { result = "ä¸­åº¦æ¹¿æ°”ï¼šå·²ç»åœ¨é‡åº¦æ¹¿æ°”çš„è¾¹ç¼˜ï¼Œèº«ä½“éšæ—¶æœ‰å¯èƒ½å‡ºç°é—®é¢˜ï¼Œé™¤äº†è¦å¢åŠ è¿åŠ¨ã€å°‘å¹ç©ºè°ƒã€é¥®é£Ÿè°ƒæ•´ä¹‹å¤–ï¼Œå»ºè®®å¯ä»¥å¤šé¥®ç”¨èµ¤å°è±†è–ç±³èŒ¶ç­‰ç¥›æ¹¿é£Ÿç‰©ï¼Œä»¥è¾¾åˆ°æ§åˆ¶ä½“å†…æ¹¿æ°”çš„ç›®çš„ã€‚å»ºè®®é¥®ç”¨èµ¤å°è±†è–ç±³èŒ¯è‹“èŒ¶ç¥›æ¹¿èŒ¶ï¼Œè½»æ¾å»é™¤æ¹¿æ°”ã€‚"; } else { result = "ä¸¥é‡æ¹¿æ°”ï¼šå·²ç»ä¸ºä¸¥é‡æ¹¿æ°”ä½“è´¨ï¼Œå»ºè®®è¦åšåˆ°ä»¥ä¸‹å‡ ç‚¹ï¼š<br>1ã€é€‚é‡å¢åŠ è¿åŠ¨ã€æˆ’çƒŸæˆ’é…’ä¸ºä½³ã€‚<br>2ã€å°‘å¹ç©ºè°ƒï¼Œå°‘åƒç”Ÿå†·ã€å¯’å‡‰çš„é£Ÿç‰©ã€‚<br>3ã€å¤šé¥®ç”¨èµ¤å°è±†è–ç±³èŒ¶ç­‰ç¥›æ¹¿é£Ÿç‰©ã€‚<br>4ã€é¥®é£Ÿå°‘æ²¹å°‘ç›ï¼Œå°½é‡æ¸…æ·¡ä¸ºä¸»ã€‚<br>5ã€æ‰¾ä¸“ä¸šçš„å…»ç”Ÿã€ä¸­åŒ»å¸ˆå’¨è¯¢èº«ä½“çŠ¶æ€ï¼Œå¦‚æœ‰éœ€è¦ï¼Œå¯å°±åŒ»æ¥å—æ£€æŸ¥ã€‚"; }
            result += `<br><br>ï¼ˆæ‚¨å›ç­”â€œæ˜¯â€çš„é¢˜æ•°ï¼š${score} / 15ï¼‰`;
            document.getElementById('dampnessResultContent').innerHTML = result;
        }

        // =================================================================
        // SCRIPT FOR NINE CONSTITUTIONS TEST
        // =================================================================
        const nineConstitutionsQuestions = [
            { id: 'gender', type: 'prelim', text: '1. æ‚¨çš„æ€§åˆ«æ˜¯ï¼Ÿ', options: ['ç”·æ€§', 'å¥³æ€§'] },
            { id: 'age', type: 'prelim', text: '2. æ‚¨çš„å¹´é¾„æ®µæ˜¯ï¼Ÿ', options: ['20å²ä»¥ä¸‹', '20-39å²', '40-59å²', '60å²åŠä»¥ä¸Š'] },
            { text: '3. æ‚¨æ‰‹è„šå‘å‡‰å—ï¼Ÿ', type: 'yang_xu' }, { text: '4. æ‚¨èƒƒè„˜éƒ¨ã€èƒŒéƒ¨æˆ–è…°è†éƒ¨æ€•å†·å—ï¼Ÿ', type: 'yang_xu' }, { text: '5. æ‚¨æ„Ÿåˆ°æ€•å†·ã€è¡£æœæ¯”åˆ«äººç©¿å¾—å¤šå—ï¼Ÿ', type: 'yang_xu' }, { text: '6. æ‚¨æ¯”ä¸€èˆ¬äººè€å—ä¸äº†å¯’å†·ï¼ˆå¦‚å†¬å¤©çš„å¯’å†·ï¼Œå¤å¤©çš„å†·ç©ºè°ƒï¼‰å—ï¼Ÿ', type: 'yang_xu' }, { text: '7. æ‚¨æ¯”åˆ«äººå®¹æ˜“æ‚£æ„Ÿå†’å—ï¼Ÿ', type: 'yang_xu' }, { text: '8. æ‚¨åƒï¼ˆå–ï¼‰å‡‰çš„ä¸œè¥¿ä¼šæ„Ÿåˆ°ä¸èˆ’æœå—ï¼Ÿ', type: 'yang_xu' }, { text: '9. æ‚¨å—å‡‰æˆ–åƒï¼ˆå–ï¼‰å‡‰çš„ä¸œè¥¿åï¼Œå®¹æ˜“è…¹æ³»å—ï¼Ÿ', type: 'yang_xu' },
            { text: '10. æ‚¨æ„Ÿåˆ°æ‰‹è„šå¿ƒå‘çƒ­å—ï¼Ÿ', type: 'yin_xu' }, { text: '11. æ‚¨æ„Ÿè§‰èº«ä½“ã€è„¸ä¸Šå‘çƒ­å—ï¼Ÿ', type: 'yin_xu' }, { text: '12. æ‚¨çš®è‚¤æˆ–å£å”‡å¹²å—ï¼Ÿ', type: 'yin_xu' }, { text: '13. æ‚¨å£å”‡çš„é¢œè‰²æ¯”ä¸€èˆ¬äººçº¢å—ï¼Ÿ', type: 'yin_xu' }, { text: '14. æ‚¨å®¹æ˜“ä¾¿ç§˜æˆ–å¤§ä¾¿å¹²ç‡¥å—ï¼Ÿ', type: 'yin_xu' }, { text: '15. æ‚¨é¢éƒ¨ä¸¤é¢§æ½®çº¢æˆ–åçº¢å—ï¼Ÿ', type: 'yin_xu' }, { text: '16. æ‚¨æ„Ÿåˆ°çœ¼ç›å¹²æ¶©å—ï¼Ÿ', type: 'yin_xu' }, { text: '17. æ‚¨æ„Ÿåˆ°å£å¹²èˆŒç‡¥ã€æ€»æƒ³å–æ°´å—ï¼Ÿ', type: 'yin_xu' },
            { text: '18. æ‚¨å®¹æ˜“ç–²ä¹å—ï¼Ÿ', type: 'qi_xu' }, { text: '19. æ‚¨å®¹æ˜“æ°”çŸ­ï¼ˆå‘¼å¸çŸ­ä¿ƒï¼Œæ¥ä¸ä¸Šæ°”ï¼‰å—ï¼Ÿ', type: 'qi_xu' }, { text: '20. æ‚¨å®¹æ˜“å¿ƒæ…Œå—ï¼Ÿ', type: 'qi_xu' }, { text: '21. æ‚¨å®¹æ˜“å¤´æ™•æˆ–ç«™èµ·æ—¶æ™•çœ©å—ï¼Ÿ', type: 'qi_xu' }, { text: '22. æ‚¨æ¯”åˆ«äººå®¹æ˜“æ‚£æ„Ÿå†’å—ï¼Ÿ (ä¸é˜³è™šè´¨é¢˜ç›®é‡å¤ï¼Œä½†å±ä¸åŒç»´åº¦)', type: 'qi_xu' }, { text: '23. æ‚¨å–œæ¬¢å®‰é™ã€æ‡’å¾—è¯´è¯å—ï¼Ÿ', type: 'qi_xu' }, { text: '24. æ‚¨è¯´è¯å£°éŸ³æ— åŠ›å—ï¼Ÿ', type: 'qi_xu' }, { text: '25. æ‚¨æ´»åŠ¨é‡ç¨å¤§å°±å®¹æ˜“å‡ºè™šæ±—å—ï¼Ÿ', type: 'qi_xu' },
            { text: '26. æ‚¨æ„Ÿåˆ°èƒ¸é—·æˆ–è…¹éƒ¨èƒ€æ»¡å—ï¼Ÿ', type: 'tan_shi' }, { text: '27. æ‚¨æ„Ÿåˆ°èº«ä½“æ²‰é‡ä¸è½»æ¾å—ï¼Ÿ', type: 'tan_shi' }, { text: '28. æ‚¨è…¹éƒ¨è‚¥æ»¡æ¾è½¯å—ï¼Ÿ', type: 'tan_shi' }, { text: '29. æ‚¨æœ‰é¢éƒ¨æ²¹è„‚åˆ†æ³Œå¤šçš„ç°è±¡å—ï¼Ÿ', type: 'tan_shi' }, { text: '30. æ‚¨ä¸Šçœ¼ç‘æ¯”åˆ«äººè‚¿å—ï¼Ÿ', type: 'tan_shi' }, { text: '31. æ‚¨å˜´é‡Œæœ‰é»é»çš„æ„Ÿè§‰å—ï¼Ÿ', type: 'tan_shi' }, { text: '32. æ‚¨å¹³æ—¶ç—°å¤šï¼Œå’½å–‰éƒ¨æ€»æ„Ÿåˆ°æœ‰ç—°å µç€å—ï¼Ÿ', type: 'tan_shi' }, { text: '33. æ‚¨èˆŒè‹”åšè…»å—ï¼Ÿ', type: 'tan_shi' },
            { text: '34. æ‚¨é¢éƒ¨æˆ–é¼»éƒ¨æœ‰æ²¹è…»æ„Ÿæˆ–è€…æ²¹äº®å‘å…‰å—ï¼Ÿ', type: 'shi_re' }, { text: '35. æ‚¨å®¹æ˜“ç”Ÿç—¤ç–®æˆ–ç–®ç––å—ï¼Ÿ', type: 'shi_re' }, { text: '36. æ‚¨æ„Ÿåˆ°å£è‹¦æˆ–å˜´é‡Œæœ‰å¼‚å‘³å—ï¼Ÿ', type: 'shi_re' }, { text: '37. æ‚¨å¤§ä¾¿é»æ»ä¸çˆ½ã€æœ‰è§£ä¸å°½çš„æ„Ÿè§‰å—ï¼Ÿ', type: 'shi_re' }, { text: '38. æ‚¨å°ä¾¿æ—¶å°¿é“æœ‰å‘çƒ­æ„Ÿã€å°¿è‰²æµ“ï¼ˆæ·±ï¼‰å—ï¼Ÿ', type: 'shi_re' }, { text: '39. (å¥³å£«å›ç­”) æ‚¨å¸¦ä¸‹è‰²é»„ï¼ˆç™½å¸¦é¢œè‰²å‘é»„ï¼‰å—ï¼Ÿ', type: 'shi_re', gender: 'å¥³æ€§' }, { text: '40. (ç”·å£«å›ç­”) æ‚¨çš„é˜´å›Šéƒ¨ä½æ½®æ¹¿å—ï¼Ÿ', type: 'shi_re', gender: 'ç”·æ€§' },
            { text: '41. æ‚¨çš„çš®è‚¤åœ¨ä¸çŸ¥ä¸è§‰ä¸­ä¼šå‡ºç°é’ç´«ç˜€æ–‘å—ï¼Ÿ', type: 'xue_yu' }, { text: '42. æ‚¨ä¸¤é¢§éƒ¨æœ‰ç»†å¾®çº¢ä¸å—ï¼Ÿ', type: 'xue_yu' }, { text: '43. æ‚¨èº«ä½“ä¸Šæœ‰å“ªé‡Œç–¼ç—›å—ï¼Ÿ', type: 'xue_yu' }, { text: '44. æ‚¨é¢è‰²æ™¦é»¯æˆ–å®¹æ˜“å‡ºç°è¤æ–‘å—ï¼Ÿ', type: 'xue_yu' }, { text: '45. æ‚¨å®¹æ˜“æœ‰é»‘çœ¼åœˆå—ï¼Ÿ', type: 'xue_yu' }, { text: '46. æ‚¨å®¹æ˜“å¿˜äº‹ï¼ˆå¥å¿˜ï¼‰å—ï¼Ÿ', type: 'xue_yu' }, { text: '47. æ‚¨å£å”‡é¢œè‰²åé»¯å—ï¼Ÿ', type: 'xue_yu' },
            { text: '48. æ‚¨æ²¡æœ‰æ„Ÿå†’æ—¶ä¹Ÿä¼šæ‰“å–·åšå—ï¼Ÿ', type: 'te_bing' }, { text: '49. æ‚¨æ²¡æœ‰æ„Ÿå†’æ—¶ä¹Ÿä¼šé¼»å¡ã€æµé¼»æ¶•å—ï¼Ÿ', type: 'te_bing' }, { text: '50. æ‚¨æœ‰å› å­£èŠ‚ã€æ¸©åº¦å˜åŒ–æˆ–å¼‚å‘³ç­‰åŸå› è€Œå’³å–˜çš„ç°è±¡å—ï¼Ÿ', type: 'te_bing' }, { text: '51. æ‚¨å®¹æ˜“è¿‡æ•ï¼ˆå¯¹è¯ç‰©ã€é£Ÿç‰©ã€æ°”å‘³ã€èŠ±ç²‰ç­‰ï¼‰å—ï¼Ÿ', type: 'te_bing' }, { text: '52. æ‚¨çš„çš®è‚¤å®¹æ˜“èµ·è¨éº»ç–¹ï¼ˆé£å›¢ï¼‰å—ï¼Ÿ', type: 'te_bing' }, { text: '53. æ‚¨çš„çš®è‚¤å› è¿‡æ•å‡ºç°è¿‡ç´«ç™œï¼ˆç´«çº¢è‰²ç˜€ç‚¹ï¼‰å—ï¼Ÿ', type: 'te_bing' }, { text: '54. æ‚¨çš„çš®è‚¤ä¸€æŠ“å°±çº¢ï¼Œå¹¶å‡ºç°æŠ“ç—•å—ï¼Ÿ', type: 'te_bing' },
            { text: '55. æ‚¨æ„Ÿåˆ°é—·é—·ä¸ä¹ã€æƒ…ç»ªä½æ²‰å—ï¼Ÿ', type: 'qi_yu' }, { text: '56. æ‚¨å®¹æ˜“ç²¾ç¥ç´§å¼ ã€ç„¦è™‘ä¸å®‰å—ï¼Ÿ', type: 'qi_yu' }, { text: '57. æ‚¨å¤šæ„å–„æ„Ÿã€æ„Ÿæƒ…è„†å¼±å—ï¼Ÿ', type: 'qi_yu' }, { text: '58. æ‚¨å®¹æ˜“æ„Ÿåˆ°å®³æ€•æˆ–å—åˆ°æƒŠå“å—ï¼Ÿ', type: 'qi_yu' }, { text: '59. æ‚¨èƒè‚‹éƒ¨æˆ–ä¹³æˆ¿èƒ€ç—›å—ï¼Ÿ', type: 'qi_yu' }, { text: '60. æ‚¨æ— ç¼˜æ— æ•…å¹æ°”å—ï¼Ÿ', type: 'qi_yu' }, { text: '61. æ‚¨å’½å–‰éƒ¨æœ‰å¼‚ç‰©æ„Ÿï¼Œåä¹‹ä¸å‡ºã€å’½ä¹‹ä¸ä¸‹å—ï¼Ÿ', type: 'qi_yu' },
            { text: '62. æ‚¨ç²¾åŠ›å……æ²›å—ï¼Ÿ', type: 'ping_he' }, { text: '63. æ‚¨å®¹æ˜“ç–²ä¹å—ï¼Ÿ', type: 'ping_he', reverse: true }, { text: '64. æ‚¨è¯´è¯å£°éŸ³æ— åŠ›å—ï¼Ÿ', type: 'ping_he', reverse: true }, { text: '65. æ‚¨æ„Ÿåˆ°é—·é—·ä¸ä¹ã€æƒ…ç»ªä½æ²‰å—ï¼Ÿ', type: 'ping_he', reverse: true }, { text: '66. æ‚¨æ¯”ä¸€èˆ¬äººè€å—ä¸äº†å¯’å†·å—ï¼Ÿ', type: 'ping_he', reverse: true }, { text: '67. æ‚¨èƒ½é€‚åº”å¤–ç•Œè‡ªç„¶å’Œç¤¾ä¼šç¯å¢ƒçš„å˜åŒ–å—ï¼Ÿ', type: 'ping_he' }, { text: '68. æ‚¨å®¹æ˜“å¤±çœ å—ï¼Ÿ', type: 'ping_he', reverse: true }, { text: '69. æ‚¨å®¹æ˜“å¿˜äº‹ï¼ˆå¥å¿˜ï¼‰å—ï¼Ÿ', type: 'ping_he', reverse: true },
        ];
        const nineConstitutionsOptionLabels = ["æ²¡æœ‰", "å¾ˆå°‘", "å¶å°”", "ç»å¸¸", "æ€»æ˜¯"];
        const constitutionNames = {
            ping_he: 'å¹³å’Œè´¨', qi_xu: 'æ°”è™šè´¨', yang_xu: 'é˜³è™šè´¨', yin_xu: 'é˜´è™šè´¨', tan_shi: 'ç—°æ¹¿è´¨',
            shi_re: 'æ¹¿çƒ­è´¨', xue_yu: 'è¡€ç˜€è´¨', qi_yu: 'æ°”éƒè´¨', te_bing: 'ç‰¹ç¦€è´¨'
        };
        // Data from the document
        const constitutionDetails = {
            ping_he: {
                title: "å¹³å’Œè´¨",
                content: `<p><strong>æ€»ä½“ç‰¹å¾ï¼š</strong>é˜´é˜³æ°”è¡€è°ƒå’Œï¼Œä»¥ä½“æ€é€‚ä¸­ã€é¢è‰²çº¢æ¶¦ã€ç²¾åŠ›å……æ²›ç­‰ä¸ºä¸»è¦ç‰¹å¾ã€‚</p><p><strong>å½¢ä½“ç‰¹å¾ï¼š</strong>ä½“å½¢åŒ€ç§°å¥å£®ã€‚</p><p><strong>å¸¸è§è¡¨ç°ï¼š</strong>é¢è‰²ã€è‚¤è‰²æ¶¦æ³½ï¼Œå¤´å‘ç¨ å¯†æœ‰å…‰æ³½ï¼Œç›®å…‰æœ‰ç¥ï¼Œå”‡è‰²çº¢æ¶¦ï¼Œä¸æ˜“ç–²åŠ³ï¼Œç²¾åŠ›å……æ²›ï¼Œè€å—å¯’çƒ­ï¼Œç¡çœ è‰¯å¥½ï¼Œèƒƒçº³ä½³ï¼ŒäºŒä¾¿æ­£å¸¸ã€‚</p><p><strong>å¿ƒç†ç‰¹å¾ï¼š</strong>æ€§æ ¼éšå’Œå¼€æœ—ã€‚</p><p><strong>å‘ç—…å€¾å‘ï¼š</strong>å¹³ç´ æ‚£ç—…è¾ƒå°‘ã€‚</p><p><strong>å¯¹å¤–ç•Œç¯å¢ƒé€‚åº”èƒ½åŠ›ï¼š</strong>å¯¹è‡ªç„¶ç¯å¢ƒå’Œç¤¾ä¼šç¯å¢ƒé€‚åº”èƒ½åŠ›è¾ƒå¼ºã€‚</p>`
            },
            qi_xu: {
                title: "æ°”è™šè´¨",
                content: `<p><strong>æ€»ä½“ç‰¹å¾ï¼š</strong>å…ƒæ°”ä¸è¶³ï¼Œä»¥ç–²ä¹ã€æ°”çŸ­ã€è‡ªæ±—ç­‰æ°”è™šè¡¨ç°ä¸ºä¸»è¦ç‰¹å¾ã€‚</p><p><strong>å½¢ä½“ç‰¹å¾ï¼š</strong>è‚Œè‚‰æ¾è½¯ä¸å®ã€‚</p><p><strong>å¸¸è§è¡¨ç°ï¼š</strong>å¹³ç´ è¯­éŸ³ä½å¼±ï¼Œæ°”çŸ­æ‡’è¨€ï¼Œå®¹æ˜“ç–²ä¹ï¼Œç²¾ç¥ä¸æŒ¯ï¼Œæ˜“å‡ºæ±—ï¼ŒèˆŒæ·¡çº¢ï¼ŒèˆŒè¾¹æœ‰é½¿ç—•ã€‚</p><p><strong>å¿ƒç†ç‰¹å¾ï¼š</strong>æ€§æ ¼å†…å‘ï¼Œä¸å–œå†’é™©ã€‚</p><p><strong>å‘ç—…å€¾å‘ï¼š</strong>æ˜“æ‚£æ„Ÿå†’ã€å†…è„ä¸‹å‚ç­‰ç—…ï¼›ç—…ååº·å¤ç¼“æ…¢ã€‚</p><p><strong>å¯¹å¤–ç•Œç¯å¢ƒé€‚åº”èƒ½åŠ›ï¼š</strong>ä¸è€å—é£ã€å¯’ã€æš‘ã€æ¹¿é‚ªã€‚</p>`
            },
            yang_xu: {
                title: "é˜³è™šè´¨",
                content: `<p><strong>æ€»ä½“ç‰¹å¾ï¼š</strong>é˜³æ°”ä¸è¶³ï¼Œä»¥ç•å¯’æ€•å†·ã€æ‰‹è¶³ä¸æ¸©ç­‰è™šå¯’è¡¨ç°ä¸ºä¸»è¦ç‰¹å¾ã€‚</p><p><strong>å½¢ä½“ç‰¹å¾ï¼š</strong>è‚Œè‚‰æ¾è½¯ä¸å®ã€‚</p><p><strong>å¸¸è§è¡¨ç°ï¼š</strong>å¹³ç´ ç•å†·ï¼Œæ‰‹è¶³ä¸æ¸©ï¼Œå–œçƒ­é¥®é£Ÿï¼Œç²¾ç¥ä¸æŒ¯ï¼ŒèˆŒæ·¡èƒ–å«©ã€‚</p><p><strong>å¿ƒç†ç‰¹å¾ï¼š</strong>æ€§æ ¼å¤šæ²‰é™ã€å†…å‘ã€‚</p><p><strong>å‘ç—…å€¾å‘ï¼š</strong>æ˜“æ‚£ç—°é¥®ã€è‚¿èƒ€ã€æ³„æ³»ç­‰ç—…ï¼›æ„Ÿé‚ªæ˜“ä»å¯’åŒ–ã€‚</p><p><strong>å¯¹å¤–ç•Œç¯å¢ƒé€‚åº”èƒ½åŠ›ï¼š</strong>è€å¤ä¸è€å†¬ï¼›æ˜“æ„Ÿé£ã€å¯’ã€æ¹¿é‚ªã€‚</p>`
            },
            yin_xu: {
                title: "é˜´è™šè´¨",
                content: `<p><strong>æ€»ä½“ç‰¹å¾ï¼š</strong>é˜´æ¶²äºå°‘ï¼Œä»¥å£ç‡¥å’½å¹²ã€æ‰‹è¶³å¿ƒçƒ­ç­‰è™šçƒ­è¡¨ç°ä¸ºä¸»è¦ç‰¹å¾ã€‚</p><p><strong>å½¢ä½“ç‰¹å¾ï¼š</strong>ä½“å½¢åç˜¦ã€‚</p><p><strong>å¸¸è§è¡¨ç°ï¼š</strong>æ‰‹è¶³å¿ƒçƒ­ï¼Œå£ç‡¥å’½å¹²ï¼Œé¼»å¾®å¹²ï¼Œå–œå†·é¥®ï¼Œå¤§ä¾¿å¹²ç‡¥ï¼ŒèˆŒçº¢å°‘æ´¥ã€‚</p><p><strong>å¿ƒç†ç‰¹å¾ï¼š</strong>æ€§æƒ…æ€¥èºï¼Œå¤–å‘å¥½åŠ¨ï¼Œæ´»æ³¼ã€‚</p><p><strong>å‘ç—…å€¾å‘ï¼š</strong>æ˜“æ‚£è™šåŠ³ã€å¤±ç²¾ã€ä¸å¯ç­‰ç—…ï¼›æ„Ÿé‚ªæ˜“ä»çƒ­åŒ–ã€‚</p><p><strong>å¯¹å¤–ç•Œç¯å¢ƒé€‚åº”èƒ½åŠ›ï¼š</strong>è€å†¬ä¸è€å¤ï¼›ä¸è€å—æš‘ã€çƒ­ã€ç‡¥é‚ªã€‚</p>`
            },
            tan_shi: {
                title: "ç—°æ¹¿è´¨",
                content: `<p><strong>æ€»ä½“ç‰¹å¾ï¼š</strong>ç—°æ¹¿å‡èšï¼Œä»¥å½¢ä½“è‚¥èƒ–ã€è…¹éƒ¨è‚¥æ»¡ã€å£é»è‹”è…»ç­‰ç—°æ¹¿è¡¨ç°ä¸ºä¸»è¦ç‰¹å¾ã€‚</p><p><strong>å½¢ä½“ç‰¹å¾ï¼š</strong>ä½“å½¢è‚¥èƒ–ï¼Œè…¹éƒ¨è‚¥æ»¡æ¾è½¯ã€‚</p><p><strong>å¸¸è§è¡¨ç°ï¼š</strong>é¢éƒ¨çš®è‚¤æ²¹è„‚è¾ƒå¤šï¼Œå¤šæ±—ä¸”é»ï¼Œèƒ¸é—·ï¼Œç—°å¤šï¼Œå£é»è…»æˆ–ç”œï¼Œå–œé£Ÿè‚¥ç”˜ç”œé»ã€‚</p><p><strong>å¿ƒç†ç‰¹å¾ï¼š</strong>æ€§æ ¼åæ¸©å’Œã€ç¨³é‡ï¼Œå¤šå–„äºå¿è€ã€‚</p><p><strong>å‘ç—…å€¾å‘ï¼š</strong>æ˜“æ‚£æ¶ˆæ¸´ã€ä¸­é£ã€èƒ¸ç—¹ç­‰ç—…ã€‚</p><p><strong>å¯¹å¤–ç•Œç¯å¢ƒé€‚åº”èƒ½åŠ›ï¼š</strong>å¯¹æ¢…é›¨å­£èŠ‚åŠæ¹¿é‡ç¯å¢ƒé€‚åº”èƒ½åŠ›å·®ã€‚</p>`
            },
            shi_re: {
                title: "æ¹¿çƒ­è´¨",
                content: `<p><strong>æ€»ä½“ç‰¹å¾ï¼š</strong>æ¹¿çƒ­å†…è•´ï¼Œä»¥é¢å¢æ²¹å…‰ã€å£è‹¦ã€è‹”é»„è…»ç­‰æ¹¿çƒ­è¡¨ç°ä¸ºä¸»è¦ç‰¹å¾ã€‚</p><p><strong>å½¢ä½“ç‰¹å¾ï¼š</strong>å½¢ä½“ä¸­ç­‰æˆ–åç˜¦ã€‚</p><p><strong>å¸¸è§è¡¨ç°ï¼š</strong>é¢å¢æ²¹å…‰ï¼Œæ˜“ç”Ÿç—¤ç–®ï¼Œå£è‹¦å£å¹²ï¼Œèº«é‡å›°å€¦ï¼Œå¤§ä¾¿é»æ»ä¸ç•…æˆ–ç‡¥ç»“ï¼Œå°ä¾¿çŸ­é»„ï¼Œç”·æ€§æ˜“é˜´å›Šæ½®æ¹¿ï¼Œå¥³æ€§æ˜“å¸¦ä¸‹å¢å¤šã€‚</p><p><strong>å¿ƒç†ç‰¹å¾ï¼š</strong>å®¹æ˜“å¿ƒçƒ¦æ€¥èºã€‚</p><p><strong>å‘ç—…å€¾å‘ï¼š</strong>æ˜“æ‚£ç–®ç––ã€é»„ç–¸ã€çƒ­æ·‹ç­‰ç—…ã€‚</p><p><strong>å¯¹å¤–ç•Œç¯å¢ƒé€‚åº”èƒ½åŠ›ï¼š</strong>å¯¹å¤æœ«ç§‹åˆæ¹¿çƒ­æ°”å€™ï¼Œæ¹¿é‡æˆ–æ°”æ¸©åé«˜ç¯å¢ƒè¾ƒéš¾é€‚åº”ã€‚</p>`
            },
            xue_yu: {
                title: "è¡€ç˜€è´¨",
                content: `<p><strong>æ€»ä½“ç‰¹å¾ï¼š</strong>è¡€è¡Œä¸ç•…ï¼Œä»¥è‚¤è‰²æ™¦é»¯ã€èˆŒè´¨ç´«é»¯ç­‰è¡€ç˜€è¡¨ç°ä¸ºä¸»è¦ç‰¹å¾ã€‚</p><p><strong>å½¢ä½“ç‰¹å¾ï¼š</strong>èƒ–ç˜¦å‡è§ã€‚</p><p><strong>å¸¸è§è¡¨ç°ï¼š</strong>è‚¤è‰²æ™¦é»¯ï¼Œè‰²ç´ æ²‰ç€ï¼Œå®¹æ˜“å‡ºç°ç˜€æ–‘ï¼Œå£å”‡é»¯æ·¡ï¼ŒèˆŒé»¯æˆ–æœ‰ç˜€ç‚¹ï¼ŒèˆŒä¸‹ç»œè„‰ç´«é»¯æˆ–å¢ç²—ã€‚</p><p><strong>å¿ƒç†ç‰¹å¾ï¼š</strong>æ˜“çƒ¦ï¼Œå¥å¿˜ã€‚</p><p><strong>å‘ç—…å€¾å‘ï¼š</strong>æ˜“æ‚£ç—‡ç˜•åŠç—›è¯ã€è¡€è¯ç­‰ã€‚</p><p><strong>å¯¹å¤–ç•Œç¯å¢ƒé€‚åº”èƒ½åŠ›ï¼š</strong>ä¸è€å—å¯’é‚ªã€‚</p>`
            },
            qi_yu: {
                title: "æ°”éƒè´¨",
                content: `<p><strong>æ€»ä½“ç‰¹å¾ï¼š</strong>æ°”æœºéƒæ»ï¼Œä»¥ç¥æƒ…æŠ‘éƒã€å¿§è™‘è„†å¼±ç­‰æ°”éƒè¡¨ç°ä¸ºä¸»è¦ç‰¹å¾ã€‚</p><p><strong>å½¢ä½“ç‰¹å¾ï¼š</strong>å½¢ä½“ç˜¦è€…ä¸ºå¤šã€‚</p><p><strong>å¸¸è§è¡¨ç°ï¼š</strong>ç¥æƒ…æŠ‘éƒï¼Œæƒ…æ„Ÿè„†å¼±ï¼Œçƒ¦é—·ä¸ä¹ï¼ŒèˆŒæ·¡çº¢ï¼Œè‹”è–„ç™½ã€‚</p><p><strong>å¿ƒç†ç‰¹å¾ï¼š</strong>æ€§æ ¼å†…å‘ä¸ç¨³å®šã€æ•æ„Ÿå¤šè™‘ã€‚</p><p><strong>å‘ç—…å€¾å‘ï¼š</strong>æ˜“æ‚£è„èºã€æ¢…æ ¸æ°”ã€ç™¾åˆç—…åŠéƒè¯ç­‰ã€‚</p><p><strong>å¯¹å¤–ç•Œç¯å¢ƒé€‚åº”èƒ½åŠ›ï¼š</strong>å¯¹ç²¾ç¥åˆºæ¿€é€‚åº”èƒ½åŠ›è¾ƒå·®ï¼›ä¸é€‚åº”é˜´é›¨å¤©æ°”ã€‚</p>`
            },
            te_bing: {
                title: "ç‰¹ç¦€è´¨",
                content: `<p><strong>æ€»ä½“ç‰¹å¾ï¼š</strong>å…ˆå¤©å¤±å¸¸ï¼Œä»¥ç”Ÿç†ç¼ºé™·ã€è¿‡æ•ååº”ç­‰ä¸ºä¸»è¦ç‰¹å¾ã€‚</p><p><strong>å½¢ä½“ç‰¹å¾ï¼š</strong>è¿‡æ•ä½“è´¨è€…ä¸€èˆ¬æ— ç‰¹æ®Šï¼›å…ˆå¤©ç¦€èµ‹å¼‚å¸¸è€…æˆ–æœ‰ç•¸å½¢ï¼Œæˆ–æœ‰ç”Ÿç†ç¼ºé™·ã€‚</p><p><strong>å¸¸è§è¡¨ç°ï¼š</strong>è¿‡æ•ä½“è´¨è€…å¸¸è§å“®å–˜ã€é£å›¢ã€å’½ç—’ã€é¼»å¡ã€å–·åšç­‰ï¼›æ‚£é—ä¼ æ€§ç–¾ç—…è€…æœ‰å‚ç›´é—ä¼ ã€å…ˆå¤©æ€§ã€å®¶æ—æ€§ç‰¹å¾ã€‚</p><p><strong>å¿ƒç†ç‰¹å¾ï¼š</strong>éšç¦€è´¨ä¸åŒæƒ…å†µå„å¼‚ã€‚</p><p><strong>å‘ç—…å€¾å‘ï¼š</strong>è¿‡æ•ä½“è´¨è€…æ˜“æ‚£å“®å–˜ã€è¨éº»ç–¹ã€èŠ±ç²‰ç—‡åŠè¯ç‰©è¿‡æ•ç­‰ï¼›é—ä¼ æ€§ç–¾ç—…å¦‚è¡€å‹ç—…ç­‰ã€‚</p><p><strong>å¯¹å¤–ç•Œç¯å¢ƒé€‚åº”èƒ½åŠ›ï¼š</strong>é€‚åº”èƒ½åŠ›å·®ï¼Œå¦‚è¿‡æ•ä½“è´¨è€…å¯¹æ˜“è‡´è¿‡æ•å­£èŠ‚é€‚åº”èƒ½åŠ›å·®ï¼Œæ˜“å¼•å‘å®¿ç–¾ã€‚</p>`
            }
        };

        let nineConstitutionsTestState = { answers: {}, gender: null };

        function startNineConstitutionsTest() {
            document.getElementById('welcome').style.display = 'none';
            const container = document.getElementById('nineConstitutionsContainer');
            container.style.display = 'block';
            nineConstitutionsTestState = { answers: {}, gender: null }; // Reset state
            renderNineConstitutionsQuestions();
        }

        function renderNineConstitutionsQuestions() {
            const container = document.getElementById('nineConstitutionsContainer');
            container.innerHTML = `
                <h2>ä¹å‹ä½“è´¨æ£€æµ‹</h2>
                <p>ä¸ºäº†å…¨é¢äº†è§£æ‚¨çš„ä½“è´¨çŠ¶å†µï¼Œæœ¬æµ‹è¯•åŒ…å«å¤šä¸ªé—®é¢˜ã€‚è¯·æ‚¨æ ¹æ®è¿‘ä¸€å¹´çš„å®é™…æƒ…å†µï¼Œè€å¿ƒä½œç­”ã€‚æ‚¨çš„ä¸ªäººä¿¡æ¯å°†è¢«ä¸¥æ ¼ä¿å¯†ã€‚</p>
                <div id="questions-wrapper"></div>
                <button class="test-button" id="calculateBtn" onclick="calculateNineConstitutionsResults()">å®Œæˆç­”é¢˜ï¼ŒæŸ¥çœ‹ç»“æœ</button>
                <button class="back-button" onclick="goHome()">è¿”å›é¦–é¡µ</button>
            `;
            
            const wrapper = document.getElementById('questions-wrapper');
            nineConstitutionsQuestions.forEach((q, index) => {
                const qBlock = document.createElement('div');
                qBlock.className = 'question-block';
                qBlock.id = `q-block-${index}`;
                if (q.gender) qBlock.style.display = 'none';
                const qTitle = document.createElement('div');
                qTitle.className = 'question-title';
                qTitle.textContent = q.text;
                const optsContainer = document.createElement('div');
                optsContainer.className = 'question-options';
                const currentOpts = q.options || nineConstitutionsOptionLabels;
                currentOpts.forEach((opt, optIndex) => {
                    const optBtn = document.createElement('button');
                    optBtn.className = 'option-btn';
                    optBtn.textContent = opt;
                    optBtn.onclick = () => selectNineConstitutionsOption(index, q.type === 'prelim' ? opt : (optIndex + 1), optBtn);
                    optsContainer.appendChild(optBtn);
                });
                qBlock.appendChild(qTitle);
                qBlock.appendChild(optsContainer);
                wrapper.appendChild(qBlock);
            });
            document.getElementById('q-block-0').classList.add('expanded');
        }
        
        function selectNineConstitutionsOption(qIndex, value, selectedBtn) {
            nineConstitutionsTestState.answers[qIndex] = value;
            const qBlock = document.getElementById(`q-block-${qIndex}`);
            qBlock.querySelectorAll('.option-btn').forEach(btn => btn.classList.remove('selected'));
            selectedBtn.classList.add('selected');
            if (nineConstitutionsQuestions[qIndex].id === 'gender') {
                nineConstitutionsTestState.gender = value;
                updateGenderQuestions();
            }
            const nextIndex = qIndex + 1;
            if (nextIndex < nineConstitutionsQuestions.length) {
                let nextBlock = document.getElementById(`q-block-${nextIndex}`);
                if (nextBlock && nextBlock.style.display === 'none' && nextIndex + 1 < nineConstitutionsQuestions.length) {
                     nextBlock = document.getElementById(`q-block-${nextIndex + 1}`);
                }
                if(nextBlock) nextBlock.classList.add('expanded');
            }
        }

        function updateGenderQuestions() {
            nineConstitutionsQuestions.forEach((q, index) => {
                if (q.gender) {
                    const block = document.getElementById(`q-block-${index}`);
                    if (q.gender === nineConstitutionsTestState.gender) {
                        block.style.display = 'block';
                    } else {
                        block.style.display = 'none';
                        if(nineConstitutionsTestState.answers.hasOwnProperty(index)) {
                            delete nineConstitutionsTestState.answers[index];
                        }
                    }
                }
            });
        }

        function calculateNineConstitutionsResults() {
            const answers = nineConstitutionsTestState.answers;
            let totalQuestionsToAnswer = 2;
            nineConstitutionsQuestions.slice(2).forEach(q => {
                if (!q.gender || q.gender === nineConstitutionsTestState.gender) totalQuestionsToAnswer++;
            });
            
            if (Object.keys(answers).length < totalQuestionsToAnswer) {
                alert('æ‚¨è¿˜æœ‰é¢˜ç›®æœªå®Œæˆï¼Œè¯·æ£€æŸ¥å¹¶å®Œæˆæ‰€æœ‰é¢˜ç›®åæŸ¥çœ‹ç»“æœã€‚');
                return;
            }

            let rawScores = {}, questionCounts = {};
            for (const key in constitutionNames) { rawScores[key] = 0; questionCounts[key] = 0; }
            nineConstitutionsQuestions.forEach((q, index) => {
                if (q.type !== 'prelim' && (!q.gender || q.gender === nineConstitutionsTestState.gender)) {
                    questionCounts[q.type]++;
                    let score = answers[index];
                    if (q.reverse) score = 6 - score;
                    rawScores[q.type] += score;
                }
            });

            let convertedScores = [];
            for (const type in rawScores) {
                const count = questionCounts[type];
                if (count > 0) {
                    const convertedScore = ((rawScores[type] - count) / (count * 4)) * 100;
                    convertedScores.push({ type: type, score: convertedScore, name: constitutionNames[type] });
                }
            }
            convertedScores.sort((a, b) => b.score - a.score);

            document.getElementById('nineConstitutionsContainer').style.display = 'none';
            document.getElementById('nineConstitutionsResultBox').style.display = 'block';
            
            const main = convertedScores[0];
            const secondary = convertedScores[1];

            // --- Display Results (UPDATED) ---
            document.getElementById('resultContentNine').innerHTML = `æ ¹æ®æ‚¨çš„ç­”é¢˜æ•°æ®ï¼Œæ‚¨çš„ä¸»ä½“è´¨ä¸º <span class="main-constitution-name">${main.name}</span>ï¼Œåå‘ä½“è´¨ä¸º <span class="secondary-constitution-name">${secondary.name}</span>ã€‚`;
            
            const mainDetailsData = constitutionDetails[main.type];
            const mainDetailsContainer = document.getElementById('mainConstitutionDetails');
            mainDetailsContainer.innerHTML = `<h3>ã€ä¸»ä½“è´¨ã€‘${mainDetailsData.title}</h3>${mainDetailsData.content}`;

            const secondaryDetailsData = constitutionDetails[secondary.type];
            const secondaryDetailsContainer = document.getElementById('secondaryConstitutionDetails');
            secondaryDetailsContainer.innerHTML = `<h3>ã€åå‘ä½“è´¨ã€‘${secondaryDetailsData.title}</h3>${secondaryDetailsData.content}`;
        }

        // =================================================================
        // GENERAL UTILITY FUNCTIONS
        // =================================================================
        function goHome() {
            // Hide all test and result divs
            document.getElementById('dampnessQuestionBox').style.display = 'none';
            document.getElementById('dampnessResultBox').style.display = 'none';
            document.getElementById('nineConstitutionsContainer').style.display = 'none';
            document.getElementById('nineConstitutionsResultBox').style.display = 'none';
            // Show the welcome screen
            document.getElementById('welcome').style.display = 'block';
        }
    </script>
</body>
</html>